# Imitation Learning Neural Network Model for AUV Control

This module implements an imitation learning pipeline for Autonomous Underwater Vehicle (AUV) control, where a neural network is trained to mimic the optimal control actions generated by a nonlinear Model Predictive Control (NL-MPC) policy. The neural network learns to approximate the mapping from current and desired vehicle states to optimal thruster commands.

## Overview

- **Goal:** Replace computationally expensive CasADi-based NL-MPC with a fast neural network controller for real-time AUV control.
- **Approach:** Train a neural network using supervised learning on data generated by the NL-MPC controller.
- **Model:** The architecture (`FossenNet`) is designed to capture the nonlinear dynamics of marine vehicles, leveraging domain knowledge (Fossen equations).

## Data Generation

### 1. From Repository

Training data is generated using the NL-MPC controller from a dedicated simulation repository:  
[auv_simulation](https://github.com/elymsyr/auv_simulation/test/Model)

- The dataset includes:
  - Current state
  - Desired state (path)
  - Optimal thruster commands (`u_opt`)
  - Next state
- Data is stored in HDF5 format (`data.h5`).

### 2. From Docker Hub

You can also generate data using the provided Docker image.  
**Example usage:**
```sh
docker pull elymsyr/auv_control_data_generation
docker run --gpus all -it elymsyr/auv_control_data_generation -s <steps_per_iteration> -p <num_iterations>
```
- `-h`: See help
- `-s`: Number of steps in each iteration
- `-p`: Number of iterations

After the iterations are completed:
```sh
docker cp elymsyr/auv_control_data_generation:app/build/data.h5 <file_path_host>/data.h5
```

## Usage

1. **Prepare Data:**  
   Generate and export the dataset using the NL-MPC controller in [auv_simulation](https://github.com/elymsyr/auv_simulation/test/Model).

2. **Train the Model:**  
   Run the provided notebook or script (`train.ipynb`) to train the neural network on the generated data.

3. **Evaluate:**  
   The notebook provides visualization and metrics for model performance, including scatter plots, sample comparisons, and residual distributions.

## Requirements

- Python 3.11
- PyTorch
- scikit-learn
- h5py
- matplotlib
- numpy

## Security Notice

⚠️ **This module is under active development and is not production-ready.**  
There may be untested features, incomplete security measures, or vulnerabilities.  
**Do not use this system in safety-critical or production